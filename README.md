# Приложение для поиска шаблонов форм

CLI приложение для поиска шаблонов форм в базе данных на основе переданных полей.

## Описание

Приложение позволяет найти шаблон формы в базе данных, все поля которого присутствуют в запросе и типы значений совпадают. Поддерживаются следующие типы полей:

- **email** - электронная почта
- **phone** - телефон в формате `+7 ХХХ ХХХ ХХ ХХ`
- **date** - дата в формате `DD.MM.YYYY` или `YYYY-MM-DD`
- **text** - произвольный текст

## Требования

- Python 3.6 или выше
- TinyDB 4.9.0

## Установка

1. Клонируйте репозиторий или скачайте файлы проекта

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Инициализируйте тестовую базу данных:
```bash
python init_db.py
```

После выполнения этой команды будет создан файл `test_db.json` с примерами шаблонов форм.

## Использование

### Основная команда

```bash
python app.py get_tpl --имя_поля=значение --имя_поля=значение
```

### Примеры использования

**Пример 1: Поиск формы с найденным совпадением**
```bash
python app.py get_tpl --customer=John Smith --дата_заказа=27.05.2025
```
Вывод:
```
Форма заказа
```

**Пример 2: Поиск формы с дополнительными полями**
```bash
python app.py get_tpl --login=vasya --f_name1=aaa@bbb.ru --f_name2=27.05.2025
```
Вывод:
```
Проба
```

**Пример 3: Поиск формы без совпадения**
```bash
python app.py get_tpl --tumba=27.05.2025 --yumba=+7 903 123 45 78
```
Вывод:
```
{
  tumba: date,
  yumba: phone
}
```

## Структура проекта

```
.
├── app.py              # Основной файл CLI приложения
├── database.py         # Модуль для работы с базой данных
├── validators.py       # Модуль для валидации типов полей
├── init_db.py          # Скрипт для инициализации тестовой БД
├── test_db.json        # Файл базы данных (создается после init_db.py)
├── test_app_examples.py # Скрипт для проверки работы приложения
├── requirements.txt    # Зависимости проекта
└── README.md           # Документация
```

## Проверка работы приложения

Для проверки работы приложения на примерах можно использовать скрипт:

```bash
python test_app_examples.py
```

Этот скрипт запускает несколько примеров использования приложения и демонстрирует его работу.

## Формат шаблона формы

Шаблон формы представляет собой JSON объект со следующей структурой:

```json
{
  "name": "Имя шаблона",
  "имя_поля_1": "тип поля",
  "имя_поля_2": "тип поля"
}
```

Где:
- `name` - обязательное поле с именем шаблона
- `имя_поля_N` - имя поля (может быть любым)
- `тип поля` - один из типов: `email`, `phone`, `date`, `text`

### Примеры шаблонов

```json
{
  "name": "Данные пользователя",
  "login": "email",
  "tel": "phone"
}
```

```json
{
  "name": "Форма заказа",
  "customer": "text",
  "order_id": "text",
  "дата_заказа": "date",
  "contact": "phone"
}
```

## Логика поиска

Приложение ищет шаблон формы, для которого:

1. Все поля шаблона присутствуют в запросе
2. Типы значений полей совпадают с типами в шаблоне
3. В запросе может быть больше полей, чем в шаблоне - это допустимо

Если подходящий шаблон найден, возвращается его имя. Если не найден, возвращается JSON объект с полями запроса и их определенными типами.

## Валидация типов

Проверка типов производится в следующем порядке приоритета:
1. **date** - проверка формата `DD.MM.YYYY` или `YYYY-MM-DD`
2. **phone** - проверка формата `+7 ХХХ ХХХ ХХ ХХ`
3. **email** - проверка стандартного формата email
4. **text** - все остальные значения

## Автор

Создано в рамках практического задания.

## Лицензия

Проект создан в учебных целях.

